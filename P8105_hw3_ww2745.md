p8105_hw3_ww2745
================
ww2745
2024-10-14

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(ggridges)
library(patchwork)
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

\##Problem 1

\##Problem 2

Load and organize the dataset.

``` r
demo_df=
  read_csv(file="./data/nhanes_covar.csv",
           skip = 4) |> 
  janitor::clean_names() |> 
  filter(age>21) |> 
  drop_na() |> 
  mutate(
    sex = 
      case_match(
        sex, 
        1 ~ "male", 
        2 ~ "female"),
    sex = as.factor(sex)) |> 
  drop_na(sex)
```

    ## Rows: 250 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (5): SEQN, sex, age, BMI, education
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
demo_df
```

    ## # A tibble: 225 × 5
    ##     seqn sex      age   bmi education
    ##    <dbl> <fct>  <dbl> <dbl>     <dbl>
    ##  1 62161 male      22  23.3         2
    ##  2 62164 female    44  23.2         3
    ##  3 62174 male      80  33.9         3
    ##  4 62177 male      51  20.1         2
    ##  5 62178 male      80  28.5         2
    ##  6 62180 male      35  27.9         3
    ##  7 62184 male      26  22.1         2
    ##  8 62189 female    30  22.4         3
    ##  9 62199 male      57  28           3
    ## 10 62202 male      36  24.7         1
    ## # ℹ 215 more rows

``` r
acc_df=
  read_csv(file="./data/nhanes_accel.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    min1:min1440,
    names_to = "minute",
    names_prefix = "min",
    values_to = "mims"
  ) |> 
  mutate(
    minute = as.factor(minute))
```

    ## Rows: 250 Columns: 1441
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (1441): SEQN, min1, min2, min3, min4, min5, min6, min7, min8, min9, min1...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
acc_df
```

    ## # A tibble: 360,000 × 3
    ##     seqn minute  mims
    ##    <dbl> <fct>  <dbl>
    ##  1 62161 1      1.11 
    ##  2 62161 2      3.12 
    ##  3 62161 3      1.47 
    ##  4 62161 4      0.938
    ##  5 62161 5      1.60 
    ##  6 62161 6      0.145
    ##  7 62161 7      2.10 
    ##  8 62161 8      0.509
    ##  9 62161 9      1.63 
    ## 10 62161 10     1.20 
    ## # ℹ 359,990 more rows

``` r
merge_df = 
  left_join(acc_df, demo_df, by = "seqn")
merge_df
```

    ## # A tibble: 360,000 × 7
    ##     seqn minute  mims sex     age   bmi education
    ##    <dbl> <fct>  <dbl> <fct> <dbl> <dbl>     <dbl>
    ##  1 62161 1      1.11  male     22  23.3         2
    ##  2 62161 2      3.12  male     22  23.3         2
    ##  3 62161 3      1.47  male     22  23.3         2
    ##  4 62161 4      0.938 male     22  23.3         2
    ##  5 62161 5      1.60  male     22  23.3         2
    ##  6 62161 6      0.145 male     22  23.3         2
    ##  7 62161 7      2.10  male     22  23.3         2
    ##  8 62161 8      0.509 male     22  23.3         2
    ##  9 62161 9      1.63  male     22  23.3         2
    ## 10 62161 10     1.20  male     22  23.3         2
    ## # ℹ 359,990 more rows

Exploratory analyses based on education level.

This is a table for the number of men and women in each education
category.

``` r
merge_df =
  mutate(merge_df,
    education = 
      case_match(
        education, 
        1 ~ "less_than_high_school", 
        2 ~ "high_school_equivalent",
        3 ~ "more_than_high_school"),
    education = as.factor(education),
    seqn = as.factor(seqn)) 

merge_df |> 
  group_by(sex, education) |>
  summarize(n_obs = n()) |> 
  pivot_wider(
    names_from = education,
    values_from = n_obs) |> 
  knitr::kable(digits = 1)
```

    ## `summarise()` has grouped output by 'sex'. You can override using the `.groups`
    ## argument.

| sex | high_school_equivalent | less_than_high_school | more_than_high_school | NA |
|:---|---:|---:|---:|---:|
| female | 33120 | 40320 | 84960 | NA |
| male | 48960 | 38880 | 77760 | NA |
| NA | NA | NA | NA | 36000 |

Most of the participants have education level at least equivalent to
high school.

This graph shows the age distributions for men and women in each
education category.

``` r
ggplot(merge_df, aes(x = age, fill = sex)) + 
  geom_density(alpha = .5) + 
  viridis::scale_fill_viridis(discrete = TRUE)
```

    ## Warning: Removed 36000 rows containing non-finite outside the scale range
    ## (`stat_density()`).

<img src="P8105_hw3_ww2745_files/figure-gfm/age_distribution-1.png" width="90%" />
The highest peak for women is around 30, and for men is 80.

Now I’m going to make a graph showing the aggregated activity counts:
